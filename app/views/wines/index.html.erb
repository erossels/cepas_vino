<% if user_signed_in? || admin_signed_in?%>
  <h1>Wines</h1>

  <table class='table table-sm col-8'>
    <thead>
      <tr>
        <th>Name</th>
        <th>Composition</th>
        <th>Reviews</th>
        <th colspan="3"></th>
      </tr>
    </thead>

    <tbody>
      <% @wines.each do |wine| %>
        <tr>
          <td><%= wine.name %></td>
          <td>
            <ul>
              <% wine.order_strains.each do |strain| %> 
                <li><%= strain %></li>
              <% end %>
            </ul>
          </td>
          <td>
            <ul>
              <% wine.oenologist_ids.uniq.each do |oenologist| %>
                <% list_of_reviews(oenologist, wine.id).each do |review| %>
                  <li>Score: <%= review.score%>, Reviewer: <%= Oenologist.find(oenologist).name%></li>
                <% end  %>
              <% end  %>
            </ul>
          </td>
          <td><%= link_to 'Show', wine %>
          <%= link_to 'Edit', edit_wine_path(wine) %>
          <%= link_to 'Destroy', wine, method: :delete, data: { confirm: 'Are you sure?' } %>
          </td>
        </tr>
      <% end %>
    </tbody>
  </table>

  <br>

  <%= link_to 'New Wine', new_wine_path,:class => "btn btn-primary"%>
<% end  %>